angular.module("kaifanla",["ng"]).controller("parentCtr",function(a){a.jump=function(b){console.log(b);$.mobile.changePage(b,{transition:"slide"})};$(document).on("pagecreate",function(c){console.log("page is creating....");var d=c.target;var b=$(d).scope();var e=$(d).injector();e.invoke(function(f){f(d)(b);b.$digest()})})}).controller("startCtr",function(a){}).controller("mainCtr",function(a,b){a.hasMore=true;b.get("../data/dish_getbypage.php?start=0").success(function(c){console.log(c);a.dishList=c});a.loadMore=function(){b.get("../data/dish_getbypage.php?start="+a.dishList.length).success(function(c){if(c.length<5){a.hasMore=false}a.dishList=a.dishList.concat(c)})};a.$watch("kw",function(){if(a.kw){b.get("../data/dish_getbykw.php?kw="+a.kw).success(function(c){a.dishList=c})}});a.showDetail=function(c){console.log(c);localStorage.id=c;$.mobile.changePage("detail.html")}}).controller("detailCtr",function(a,c){var b=localStorage.id;console.log("åœ¨è¯¦æƒ…é¡µé¢æ‹¿åˆ°çš„idå‚æ•°ä¸ºï¼š"+b);c.get("../data/dish_getbyid.php?id="+b).success(function(d){a.dish=d[0]})}).controller("orderCtr",function(a,b){a.order={did:localStorage.id};a.submitOrder=function(){localStorage.phone=a.order.phone;var c=jQuery.param(a.order);b.get("../data/order_add.php?"+c).success(function(d){if(d[0].msg=="succ"){a.succMsg="è®¢é¤æˆåŠŸï¼æ‚¨çš„è®¢å•ç¼–å·ä¸ºï¼?"+d[0].did+"ã€‚æ‚¨å¯ä»¥åœ¨ç”¨æˆ·ä¸­å¿ƒæŸ¥çœ‹è®¢å•çŠ¶æ€ã??";$rootScope.phone=a.order.phone}else{a.errMsg="è®¢é¤å¤±è´¥ï¼é”™è¯¯ç ä¸ºï¼š"+d[0].reason}})}}).controller("myorderCtr",function(a,b){b.get("../data/order_getbyphone.php?phone="+localStorage.phone).success(function(c){a.orderList=c;console.log(c)})});